# This config was automatically generated from your source code
# Stacks detected: cicd:github-actions:.github/workflows, cicd:jenkins:., deps:java:.

version: 2.1

jobs:
  environment:
    docker:
      - image: cimg/openjdk:17.0
    environment:
      BRIDGE_BLACKDUCK_URL: 'https://testing.blackduck.synopsys.com'
      BRIDGE_BLACKDUCK_TOKEN: $BLACKDUCK_API_TOKEN
      BRIDGE_BLACKDUCK_SCAN_FULL: true
      BRIDGE_BLACKDUCK_SCAN_FAILURE_SEVERITIES: 'NONE'
      BRIDGECLI_LINUX64: 'https://sig-repo.synopsys.com/artifactory/bds-integrations-release/com/synopsys/integration/synopsys-bridge/latest/synopsys-bridge-linux64.zip'

  test-java:
    docker:
      - image: cimg/openjdk:17.0
    steps:
      - checkout
      - run:
          name: Install and run Black Duck scan
          command: |
            set -ex
            curl -fLsS -o bridge.zip $BRIDGECLI_LINUX64
            unzip -qo -d ~/repo bridge.zip
            rm -f bridge.zip
            ~/repo/synopsys-bridge --stage blackduck

workflows:
  version: 2
  build-and-test:
    jobs:
      - test-java:
          context:
            - BLACKDUCK
